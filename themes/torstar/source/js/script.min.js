var list=$("#sidebar ul");$("article header .title").each(function(){$(this).prepend('<a name="'+$(this).text().trim()+'"></a>'),$(list).append('<li><a href="#'+$(this).text().trim().toLowerCase().replace(/\s+/g,"-")+'">'+$(this).text().trim()+"</a></li>")});var lastId,sidebar=$("#sidebar"),sidebarHeight=sidebar.outerHeight()+15,menuItems=sidebar.find("a"),scrollItems=menuItems.map(function(){var t=$($(this).attr("href"));return t.length?t:void 0});menuItems.click(function(t){var e=$(this).attr("href"),i="#"===e?0:$(e).offset().top-30;$("html, body").stop().animate({scrollTop:i},500),t.preventDefault()}),$(window).scroll(function(){var t=$(this).scrollTop()+sidebarHeight,e=scrollItems.map(function(){return $(this).offset().top<t?this:void 0});e=e[e.length-1];var i=e&&e.length?e[0].id:"";lastId!==i&&(lastId=i,menuItems.parent().removeClass("active").end().filter("[href=#"+i+"]").parent().addClass("active"))});